<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">
<script type="text/javascript" src="./libs/google-drive.js"></script>

<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://code.jquery.com/ui/1.11.1/jquery-ui.min.js"></script>
<script type="text/javascript" src="./libs/url.min.js"></script> <!-- http://plugins.jquery.com/url/ -->

<script type="text/javascript" src="./libs/jtree/jstree.min.js"></script>
<script type="text/javascript" src="./libs/tree.js"></script>

<script type="text/javascript" src="./libs/main.js"></script>

<script type="text/javascript" src="./libs/jquery-ui-utils.js"></script>

<script type="text/javascript">
    const CLIENT_ID = "460606321746-60eoev9jsf2pqp1t37otikutqcleudmb.apps.googleusercontent.com";
    const SCOPES = "https://www.googleapis.com/auth/drive";

    const g_GoogleDrive = new GoogleDrive(CLIENT_ID, SCOPES);
    

    // js init
    $(function() {
        var mainApp = new MainApp(g_GoogleDrive, "folderTree", "contentTree");

        // root folder select
        $("#pageSelect").hide();
        $("#pageSelect").on("change", function (e) {
           mainApp.setRootFolder(this.value);
        });
    });

    /**
     * Called when the client library is loaded to start the auth flow.
     */
    function handleClientLoad() {
        g_GoogleDrive.onAuthSuccess = function() {
            authSuccess();
        };
        g_GoogleDrive.onAuthFail = function() {
            handleClientLoadFailed();
        }

        g_GoogleDrive.auth(false);
    }

    /**
     * [handleClientLoadFailed description]
     */
    function handleClientLoadFailed() {
        g_GoogleDrive.onAuthFail = function() {
            alert("auth failed");
        }

        $("#loginBtn").attr('disabled', false).click(function() {
            g_GoogleDrive.auth(true);
        });
    }

    /**
     * Auth success action.
     */
    function authSuccess() {
        // login button invisible
        $("#loginBtn").hide();

        // Access token has been successfully retrieved, requests can be sent to the API.
        g_GoogleDrive.getRootFolders(function(item) {
            $("#pageSelect").append($("<option></option>").attr("value", item.id).text(item.title));
        });
        $("#pageSelect").show();
    }  

</script>

<script type="text/javascript" src="https://apis.google.com/js/client.js?onload=handleClientLoad"></script>
<link rel="stylesheet" type="text/css" href="./libs/jtree/themes/default/style.min.css" />

<link rel="stylesheet" href="https://code.jquery.com/ui/1.11.1/themes/redmond/jquery-ui.css">
<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css">

<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
</head>

<body>
<!-- header -->
<header>
    <h1>Bookmark This Way</h1>
</header>    

<div>
    <button title="qq" id="loginBtn" class="btn btn-danger" disabled>
        <i class="fa fa-google-plus-square fa-2x" style="vertical-align:middle"></i> Login
    </button>
</div>

<div class="row" style="margin: 20px 0px;"> 
    <section class="col-xs-2"> 
        <select id="pageSelect" class="form-control">
            <option value="">choose root folder...</option>
        </select>
    </section>
</div>

<div class="row">
    <div id="folderTree" class="col-md-4"></div>

    <div id="contentTree" class="col-md-4"></div>
</div>

</body>
</html>